/*
 Copyright (c) 2026 Ashraf Morningstar
 These are personal recreations of existing projects, developed by Ashraf Morningstar
 for learning and skill development.
 Original project concepts remain the intellectual property of their respective creators.
 Repository: https://github.com/AshrafMorningstar
*/

name: Generate Cyber Stats

on:
  schedule:
    - cron: "0 0 * * *" # Daily
  workflow_dispatch:

permissions:
  contents: write

jobs:
  generate:
    name: Generate Stats
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: "npm"

      - name: Install Dependencies
        run: npm ci

      - name: Install System Dependencies (FFmpeg, etc)
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg

      - name: Render MP4
        run: npx remotion render src/index.ts CyberStats outputs/AshrafMorningstar/cyber-stats.mp4 --gl=angle

      - name: Render GIF
        # Remotion GIF rendering
        run: npx remotion render src/index.ts CyberStats outputs/AshrafMorningstar/cyber-stats.gif --gl=angle --codec=gif

      - name: Commit and Push
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "âœ¨ Update cyber stats [skip ci]"
          file_pattern: outputs/*
